const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AssistantApi-DH9lSKSi.js","assets/app-core-DsZLvh-T.js","assets/preload-helper-9zrlRb12.js","assets/Empty-CbVzuLts.js","assets/_baseIsEqual-BU7ud4ak.js","assets/app-core-DSulWsr7.css","assets/useUserHandling-aMiDhUow.js","assets/registrationModalLocalStorageId-NLzc7oHj.js","assets/useBCClientSideData-CaltDZgi.js","assets/useTranslation-DBGLPtMT.js","assets/utils-B1GDy_RR.js"])))=>i.map(i=>d[i]);
import{i as w,g as i,u as U,s as G,l as x,r as B,C as V,z as P,M as y,j as F,k as S,a as b,A as z,e as Q,h as W}from"./app-core-DsZLvh-T.js";import{r as o}from"./Empty-CbVzuLts.js";import{u as H}from"./useUserHandling-aMiDhUow.js";import{_ as K}from"./preload-helper-9zrlRb12.js";import{u as Y}from"./useTranslation-DBGLPtMT.js";try{let n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new n.Error().stack;c&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[c]="f04e0745-f905-475c-bfc0-1adb703bc880",n._sentryDebugIdIdentifier="sentry-dbid-f04e0745-f905-475c-bfc0-1adb703bc880")}catch{}{let n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n._sentryModuleMetadata=n._sentryModuleMetadata||{},n._sentryModuleMetadata[new n.Error().stack]=Object.assign({},n._sentryModuleMetadata[new n.Error().stack],{"_sentryBundlerPluginAppKey:bc-frontend":!0})}const C="assistant_universal",te="assistant_entry_point",ae="assistant_minimized",ne="assistant_suggested_query",oe="assistant_resource",p="search",ie="open",Z="close",j="minimize",ce="assistant_newthread",re="assistant_discover",Se="assistant_discover_assistant_landing",le="assistant_feedback",de="assistant feedback system message",ue="assistant feedback follow up system message",_e="assistant plan registration promo button",X=async()=>{if(w())return;{const{AssistantApi:l}=await K(async()=>{const{AssistantApi:g}=await import("./AssistantApi-DH9lSKSi.js");return{AssistantApi:g}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]));window.BCAssistantApi=new l}const{search:{actions:{receiveSearchResult:n,receiveSearchSegment:c}},chat:{actions:{appendNewAssistantMessage:E,fetchMessagesForCurrentThread:d,receiveMessageSegment:_,receiveSource:s}},common:{actions:{setIsGenerating:A,handleGenerationEnd:I,setConnectionStatus:T}}}=i.getState().assistant;window.BCAssistantApi.initialize({getIsGenerating:()=>i.getState().assistant.common.isGenerating,onMessageEnd:I,onMessageSegmentReceived:_,onMessageStart:E,onReconnect:d,onSearchResultReceived:n,onSearchSegmentReceived:c,onSourceReceived:s,setConnectionStatus:T,setIsGenerating:A})},Te=()=>{const n=U(e=>e.assistant.chat.actions.fetchThreads),{user:c}=H(),[E,d]=o.useState(),_=o.useCallback(async()=>{w()||window.BCAssistantApi!==void 0||(await X(),await n())},[n]),s=o.useCallback(async(e,t)=>{await _();const a=e();a&&typeof a.then=="function"&&await a,t&&await G(t)},[_]),A=o.useCallback(async()=>s(()=>{const{common:{actions:{setView:e}},chat:{messageStore:{currentThreadMessages:t}}}=i.getState().assistant,a=t.findLast(u=>u.author===x.USER);a!==void 0&&B(()=>P({key:y,value:a.text}),V.Experience);const r=F(y);e(r!==null?S.MINIMIZED:S.CLOSED)},b({measurementListId:C,elementId:p,context:j})),[s]),I=o.useCallback(async()=>s(()=>{const{setView:e}=i.getState().assistant.common.actions;z(y),e(S.CLOSED)},b({measurementListId:C,elementId:p,context:Z})),[s]),{t:T}=Y(),l=o.useCallback(e=>{var t;Q.isAxiosError(e)&&((t=e.response)==null?void 0:t.data.message)==="The message field must not be greater than 255 characters."&&d(T("I love details, but your message is too long. Can you shorten it?"))},[T]),g=o.useCallback(async e=>s(async()=>{const{submitQuery:t}=i.getState().assistant.chat.actions;try{d(void 0),await t(e)}catch(a){l(a)}}),[s,l]),R=o.useCallback(async e=>s(()=>{const{common:{actions:{setView:t}},chat:{actions:{clearCurrentThread:a}}}=i.getState().assistant;t(S.DISCOVER),a()},e),[s]),m=o.useCallback(async(e,t)=>s(async()=>{const{chat:{actions:{clearCurrentThread:a,submitQuery:r}},common:{actions:{setView:u}}}=i.getState().assistant;if(u(S.NEW_CHAT),a(),e)try{d(void 0),await r(e)}catch(h){l(h)}},t),[s,l]),f=o.useCallback(async(e,t)=>s(async()=>{const{chat:{currentThreadId:a,activeThreadId:r,threads:u,actions:{setCurrentThreadById:h}},common:{actions:{setView:M}}}=i.getState().assistant;if(e||(e=a),h(e),!e){await m();return}const L=!c&&u.findIndex(N=>N.id===e&&N.id!==r)>=0;M(L?S.REGISTER:S.CHAT)},t).then(()=>{const{isFirstTimeOpeningModal:a,actions:{setIsFirstTimeOpeningModal:r}}=i.getState().assistant.chat;a&&r(!1)}),[s,m,c]),D=o.useCallback(async e=>s(async()=>{const{activeThreadId:t}=i.getState().assistant.chat;await f(t)},e),[s,f]),O=o.useCallback(async e=>s(()=>{W("assistant search opened")},e),[s]),v=o.useCallback(async e=>s(()=>{const{search:{actions:{clearSearch:t}},common:{isGenerating:a}}=i.getState().assistant;a||t()},e),[s]),k=o.useCallback(async(e,t)=>s(async()=>{const{submitSearchQuery:a}=i.getState().assistant.search.actions;await a(e)},t),[s]);return{queryError:E,onClose:I,onContinueChat:g,onDiscoverClick:R,onMinimize:A,onOpen:f,onOpenWithActiveChat:D,onOpenWithNewChat:m,onSearchClose:v,onSearchOpen:O,onSearchQuerySubmit:k}};export{ae as A,p as a,_e as b,C as c,ie as d,ce as e,re as f,oe as g,le as h,Se as i,ue as j,de as k,ne as l,te as m,Te as u};
//# sourceMappingURL=useAssistantInteractions-KyZyfcCI.js.map
