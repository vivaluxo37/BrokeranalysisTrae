"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3785],{19785:function(t,e,n){function r(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}n.d(e,{Z:function(){return r}})},42765:function(t,e,n){function r(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}n.d(e,{Z:function(){return r}})},63761:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});var r=n(42765),a=n(66700),u=n(19785);function o(t,e){(0,u.Z)(2,arguments);var n=(0,a.Z)(t),o=(0,r.Z)(e);return isNaN(o)?new Date(NaN):o?(n.setDate(n.getDate()+o),n):n}},28187:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});var r=n(42765),a=n(66700),u=n(19785);function o(t,e){(0,u.Z)(2,arguments);var n=(0,a.Z)(t),o=(0,r.Z)(e);if(isNaN(o))return new Date(NaN);if(!o)return n;var i=n.getDate(),c=new Date(n.getTime());c.setMonth(n.getMonth()+o+1,0);var l=c.getDate();return i>=l?c:(n.setFullYear(c.getFullYear(),c.getMonth(),i),n)}},52946:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});var r=n(42765),a=n(28187),u=n(19785);function o(t,e){(0,u.Z)(2,arguments);var n=(0,r.Z)(e);return(0,a.default)(t,12*n)}},96913:function(t,e,n){n.d(e,{Z:function(){return o}});var r=n(63761),a=n(19785),u=n(42765);function o(t,e){(0,a.Z)(2,arguments);var n=(0,u.Z)(e);return(0,r.default)(t,-n)}},94873:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});var r=n(42765),a=n(28187),u=n(19785);function o(t,e){(0,u.Z)(2,arguments);var n=(0,r.Z)(e);return(0,a.default)(t,-n)}},46318:function(t,e,n){n.d(e,{Z:function(){return o}});var r=n(42765),a=n(52946),u=n(19785);function o(t,e){(0,u.Z)(2,arguments);var n=(0,r.Z)(e);return(0,a.default)(t,-n)}},66700:function(t,e,n){n.d(e,{Z:function(){return u}});var r=n(19785);function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t){(0,r.Z)(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===a(t)&&"[object Date]"===e?new Date(t.getTime()):"number"===typeof t||"[object Number]"===e?new Date(t):("string"!==typeof t&&"[object String]"!==e||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},43785:function(t,e,n){n.r(e),n.d(e,{CommoditiesChart:function(){return T}});var r=n(87394),a=n(52322),u=n(2784),o=n(5632),i=n(70865),c=n(69248),l=n(82066),s=1/0,d=1/0,f=function(t){var e=Array.isArray(t)?t.join(","):t;return"/commodities/rates?instruments=".concat(encodeURIComponent(e),"&includeFullData=true&includeSparkLines=true")},m=n(96913),v=n(94873),y=n(46318),g=function(t){var e=t.tabPeriod,n=t.vendorSymbol,r=function(t){switch(t){case"1d":return{granularity:"M5",startDate:(0,m.Z)(new Date,1)};case"7d":return{granularity:"M30",startDate:(0,m.Z)(new Date,7)};case"30d":return{granularity:"D",startDate:(0,v.default)(new Date,1)};case"6m":return{granularity:"D",startDate:(0,v.default)(new Date,6)};case"ytd":var e=new Date((new Date).getFullYear(),0,1);return{granularity:(0,m.Z)(new Date,7)>e?"D":(0,m.Z)(new Date,1)>e?"M30":"M5",startDate:e};case"1y":return{granularity:"D",startDate:(0,y.Z)(new Date,1)};case"5y":return{granularity:"W",startDate:(0,y.Z)(new Date,5)};case"max":var n=new Date(14015808e5);return{granularity:(0,y.Z)(new Date,1)>n?"W":(0,v.default)(new Date,1)>n?"D":"M30",startDate:n};default:throw new Error("Invalid tabPeriod")}}(e),a=r.granularity,u=r.startDate;return"/".concat("commodities/chart/candles","?")+"instrument=".concat(n)+"&granularity=".concat(a)+"&from=".concat(Math.floor(u.getTime()/1e3))+"&price=M&count=5000&weeklyAlignment=Monday&alignmentTimezone=UTC&dailyAlignment=0"},D=n(38985),h=n(47842),p=n(96670),Z=n(36061),b=n(40167),w=n(27035),C=n(26726),S=n(5788),M=n(32657),N={"1d":"today","7d":"1week","30d":"1month","6m":"6month",ytd:"ytd","1y":"1year","5y":"5year",max:"max"},T=function(t){var e=t.instrumentSlug,n=function(t){var e=t.locale,n=t.instruments,r=!!n&&n.length>0;return(0,i.Z)({queryKey:f(n)},(0,l.useQuery)(f(n),(function(){return(0,c.C)({path:f(n),locale:e})}),{cacheTime:d,staleTime:s,refetchOnWindowFocus:!1,enabled:r}))}({locale:(0,o.useRouter)().locale,instruments:e}),r=n.data,m=(0,u.useMemo)((function(){if((0,D.q)(r)){var t=function(t){var e=t.commoditiesData,n=t.slug,r=e.prices[n],a=e.entities[n],u=(0,p.Z)((0,i.Z)({},r,a),{vendor:"Oanda"});if(!r)return(0,p.Z)((0,i.Z)({},u),{lastUnconverted:null,percentChangeUnconverted:null});var o,c=r.last,l=["last","low","high"].reduce((function(t,e){var n=r[e];return null!==n?(0,p.Z)((0,i.Z)({},t),(0,h.Z)({},e,+n)):t}),{}),s=null!==(o=r.percentChange)&&void 0!==o?o:null;return(0,p.Z)((0,i.Z)({},u,l),{lastUnconverted:c,percentChangeUnconverted:s})}({commoditiesData:r.data,slug:e});if(t)return t}return null}),[r,e]);return m?(0,a.jsx)(j,{instrumentSlug:e,convertedData:m}):(0,a.jsx)(C.a,{})},j=function(t){var e,n=t.instrumentSlug,o=t.convertedData,i=(0,u.useState)(b.B8.Normal),s=i[0],d=i[1],f=(0,u.useState)("1d"),m=f[0],v=f[1],y=(0,u.useRef)(null),D=(0,u.useRef)(o.time||""),h=function(t){var e=t.tabPeriod,n=t.vendorSymbol,r=t.timestampRef,a=void 0===r?"":r,u=g({vendorSymbol:n,tabPeriod:e});return(0,l.useQuery)(["commoditiesChartData",n,e,a],(function(){return(0,c.C)({path:u})}),{cacheTime:6e4,staleTime:6e4,refetchOnWindowFocus:!1})}({vendorSymbol:o.vendorSymbol,tabPeriod:m,timestampRef:D.current}),p=h.data,C=(0,u.useMemo)((function(){if(200===(null===p||void 0===p?void 0:p.statusCode)){var t=p.data.reduce((function(t,e,n){var r=e.Date,a={value:e.Close,time:(0,M.$S)(r)};if(n===p.data.length-1){var u=p.data.length-2,o=p.data[u];return o&&r===o.Date?t:t.concat(a)}return t.concat(a)}),[]);if(Array.isArray(t)&&t.length){var e=(0,w.Q)(o.historicalPreviousClose,N,m);e&&(t[0].value=e)}var n=null===t||void 0===t?void 0:t.reduce((function(t,e){return t[e.time]=e.value,t}),{});return{chartData:t,volumes:n}}return{chartData:[],volumes:{}}}),[p,m]),T=C.chartData,j=C.volumes,P=(0,u.useMemo)((function(){return Object.entries(N).reduce((function(t,e){var n=(0,r.Z)(e,2),a=n[0],u=n[1],i=o.historicalPreviousClose[u];if(i){var c=100*(o.last/i-1);t[a]=c.toFixed(2)}else"1d"===a&&null!==o.percentChange?t[a]=o.percentChange.toFixed(2):t[a]="";return t}),{})}),[o.historicalPreviousClose,o.last,o.percentChange]);return(0,a.jsx)(S.Z,{chartRef:y,showFullChat:!0,slug:n,chartData:T,mode:s,setMode:d,period:m,setPeriod:function(t){Object.keys(N).includes(t)&&v(t)},periodsForTabs:P,instrumentType:Z.y.COMMODITIES,toolTipExtraData:{volumes:j,symbol:"$",lastClose:null!==(e=o.historicalPreviousClose[N[m]])&&void 0!==e?e:o.last}})}},27035:function(t,e,n){n.d(e,{Q:function(){return r}});var r=function(t,e,n){return null===t||void 0===t?void 0:t[null===e||void 0===e?void 0:e[n]]}}}]);